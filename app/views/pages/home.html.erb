<!-- Hero -->
<div class="hw-hero">
  <%= image_tag "logo.png", class: "hw-hero-logo", alt: "Highway to Wipe" %>
  <h1 class="hw-hero-title">Highway to Wipe</h1>
  <p class="hw-hero-subtitle">Guilde PvE ‚Ä¢ Alliance ‚Ä¢ Eitrigg</p>
</div>

<div class="hw-container">

  <!-- Grille principale : Progression + Prochain Event -->
  <div class="hw-main-grid">

    <!-- PROGRESSION RAID -->
    <div class="hw-card">
      <div class="hw-card-header">
        <span class="hw-card-icon">‚öîÔ∏è</span>
        <h2 class="hw-card-title"><%= @warcraftlogs_progression[:raid_name] %></h2>
      </div>
      <div class="hw-card-body">
        <%
          # Trouve la plus haute difficult√© avec des kills
          highest = nil
          if @warcraftlogs_progression[:mythic][:killed] > 0
            highest = { label: "Mythique", killed: @warcraftlogs_progression[:mythic][:killed], total: @warcraftlogs_progression[:mythic][:total], color: "#f44336" }
          elsif @warcraftlogs_progression[:heroic][:killed] > 0
            highest = { label: "H√©ro√Øque", killed: @warcraftlogs_progression[:heroic][:killed], total: @warcraftlogs_progression[:heroic][:total], color: "#2196f3" }
          elsif @warcraftlogs_progression[:normal][:killed] > 0
            highest = { label: "Normal", killed: @warcraftlogs_progression[:normal][:killed], total: @warcraftlogs_progression[:normal][:total], color: "#4caf50" }
          end
        %>

        <% if highest %>
          <div class="hw-prog-main">
            <div class="hw-prog-difficulty-name" style="color: <%= highest[:color] %>">
              <%= highest[:label] %>
            </div>
            <div class="hw-prog-score">
              <span class="hw-prog-killed"><%= highest[:killed] %></span>
              <span class="hw-prog-sep">/</span>
              <span class="hw-prog-total"><%= highest[:total] %></span>
            </div>
            <div class="hw-prog-bar">
              <div class="hw-prog-fill" style="width: <%= (highest[:killed].to_f / highest[:total] * 100).round %>%; background: <%= highest[:color] %>;"></div>
            </div>
          </div>
        <% else %>
          <p class="hw-empty">Aucune progression enregistr√©e</p>
        <% end %>
      </div>
    </div>

    <!-- PROCHAIN EVENT -->
    <% if @next_event.present? %>
      <div class="hw-card hw-event-card">
        <div class="hw-card-header">
          <span class="hw-card-icon">üìÖ</span>
          <h2 class="hw-card-title">Prochain Event</h2>
        </div>
        <div class="hw-card-body">
          <div class="hw-event-content">
            <span class="hw-event-icon-main"><%= @next_event.event_type_emoji %></span>
            <div class="hw-event-main">
              <div class="hw-event-name"><%= @next_event.title %></div>
              <div class="hw-event-datetime">
                <%= @next_event.start_time.strftime("%d %B") %> ‚Ä¢ <%= @next_event.start_time.strftime("%Hh%M") %>
              </div>
            </div>
            <div class="hw-event-participants-compact">
              <span class="hw-event-part-num"><%= @next_event_participants %></span> inscrit<%= @next_event_participants > 1 ? 's' : '' %>
            </div>
            <%= link_to event_path(@next_event), class: "hw-event-btn-round" do %>
              ‚Üí
            <% end %>
          </div>
        </div>
      </div>
    <% else %>
      <div class="hw-card">
        <div class="hw-card-header">
          <span class="hw-card-icon">üìÖ</span>
          <h2 class="hw-card-title">Prochain Event</h2>
        </div>
        <div class="hw-card-body">
          <p class="hw-empty">Aucun √©v√©nement pr√©vu</p>
        </div>
      </div>
    <% end %>

  </div>

  <!-- Grille activit√© : Kills + M+ + Deaths -->
  <div class="hw-activity-grid">

    <!-- KILLS R√âCENTS -->
    <div class="hw-card">
      <div class="hw-card-header">
        <span class="hw-card-icon">üèÜ</span>
        <h3 class="hw-card-title">Kills R√©cents</h3>
      </div>
      <div class="hw-card-body hw-card-list">
        <% if @warcraftlogs_recent_kills.any? %>
          <% @warcraftlogs_recent_kills.first(5).each do |kill| %>
            <div class="hw-list-item">
              <div class="hw-list-icon">üíÄ</div>
              <div class="hw-list-content">
                <div class="hw-list-name"><%= kill[:boss] %></div>
                <div class="hw-list-detail"><%= kill[:difficulty] %> ‚Ä¢ <%= kill[:date].strftime("%d/%m") %></div>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="hw-empty">Aucun kill r√©cent</p>
        <% end %>
      </div>
    </div>

    <!-- TOP MYTHIC+ -->
    <div class="hw-card">
      <div class="hw-card-header">
        <span class="hw-card-icon">üîë</span>
        <h3 class="hw-card-title">Top Mythic+</h3>
      </div>
      <div class="hw-card-body hw-card-list">
        <% if @raiderio_top_players.any? %>
          <% @raiderio_top_players.first(5).each_with_index do |player, index| %>
            <div class="hw-list-item">
              <div class="hw-list-rank">#<%= index + 1 %></div>
              <div class="hw-list-content">
                <div class="hw-list-name"><%= player[:name] %></div>
                <div class="hw-list-detail"><%= player[:class] %> <%= player[:spec] %></div>
              </div>
              <div class="hw-list-score" style="color: #64b5f6;"><%= player[:score] %></div>
            </div>
          <% end %>
        <% else %>
          <p class="hw-empty">Aucune donn√©e M+</p>
        <% end %>
      </div>
    </div>

    <!-- WALL OF SHAME -->
    <div class="hw-card">
      <div class="hw-card-header">
        <span class="hw-card-icon">üíÄ</span>
        <h3 class="hw-card-title">Wall of Shame</h3>
      </div>
      <div class="hw-card-body hw-card-list">
        <% if @warcraftlogs_death_stats.any? %>
          <% @warcraftlogs_death_stats.first(5).each_with_index do |player, index| %>
            <div class="hw-list-item">
              <div class="hw-list-rank">#<%= index + 1 %></div>
              <div class="hw-list-content">
                <div class="hw-list-name"><%= player[:player] %></div>
                <div class="hw-list-detail"><%= player[:class] %></div>
              </div>
              <div class="hw-list-score" style="color: #e57373;"><%= player[:deaths] %> üíÄ</div>
            </div>
          <% end %>
        <% else %>
          <p class="hw-empty">Aucune donn√©e</p>
        <% end %>
      </div>
    </div>

  </div>

</div>

<!-- √Ä propos -->
<div class="hw-about">
  <div class="hw-container">
    <h2 class="hw-about-title">√Ä propos</h2>
    <p class="hw-about-text">
      Highway to Wipe est une guilde PvE sur le serveur Eitrigg.
      On raid dans la bonne humeur tout en visant le contenu endgame.
    </p>
  </div>
</div>
