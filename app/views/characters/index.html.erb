


<div class="container mt-4">

  <h1 class="text-center mb-5">Roster Midnight </h1>

  <!-- Compteurs de rôles -->
  <div class="row justify-content-center mb-5">
    <div class="col-6 col-md-3 text-center mb-4">
      <div class="role-card">
        <%= image_tag("roles/tank.png", class: "role-icon-big") %>
      </div>
      <div class="role-count"><%= @role_counts["tank"] || 0 %></div>
      <div class="role-label">Tanks</div>
    </div>

    <div class="col-6 col-md-3 text-center mb-4">
      <div class="role-card">
        <%= image_tag("roles/healer.png", class: "role-icon-big") %>
      </div>
      <div class="role-count"><%= @role_counts["healer"] || 0 %></div>
      <div class="role-label">Healers</div>
    </div>

    <div class="col-6 col-md-3 text-center mb-4">
      <div class="role-card">
        <%= image_tag("roles/dps_cac.png", class: "role-icon-big") %>
      </div>
      <div class="role-count"><%= @role_counts["dps_cac"] || 0 %></div>
      <div class="role-label">DPS CAC</div>
    </div>

    <div class="col-6 col-md-3 text-center mb-4">
      <div class="role-card">
        <%= image_tag("roles/dps_caster.png", class: "role-icon-big") %>
      </div>
      <div class="role-count"><%= @role_counts["dps_caster"] || 0 %></div>
      <div class="role-label">Casters</div>
    </div>
  </div>

  <!-- Bouton d'ajout -->
  <div class="text-center mb-5">
    <% if user_signed_in? %>
      <%= link_to "Ajouter mon perso", new_character_path, class: "btn btn-primary btn-lg" %>
    <% else %>
      <%= link_to "Connecte-toi pour ajouter ton perso", new_user_session_path, class: "btn btn-secondary btn-lg" %>
    <% end %>
  </div>

  <!-- Liste des persos -->
  <% if @characters.any? %>
    <table class="table">
      <thead>
        <tr>
          <th>Pseudo</th>
          <th>Classe</th>
          <th>Spé</th>
          <th>Rôle</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @characters.each do |character| %>
          <tr>
            <td><strong><%= character.pseudo %></strong></td>
            <td>
              <%= image_tag("classes/#{character.wow_class.name.parameterize(separator: '_')}.png", class: "class-image-small") %>
              <%= character.wow_class.name %>
            </td>
            <td><%= character.specialization.name %></td>
            <td>
              <%= image_tag("roles/#{character.specialization.role}.png", class: "role-icon-small") %>
            </td>
            <td>
              <% if user_signed_in? && character.user == current_user %>
                <%= button_to "✕", character_path(character), method: :delete, class: "btn btn-sm btn-outline-danger", data: { turbo_confirm: "Supprimer ce perso ?" } %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p class="text-center empty-message">Aucun perso inscrit pour le moment.</p>
  <% end %>
</div>
